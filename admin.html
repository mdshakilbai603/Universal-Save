<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∂‡¶æ‡¶ï‡¶ø‡¶≤ - ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; color: #333; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: auto; }
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-bottom: 30px; }
        h2 { color: #0070f3; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        input[type="text"], input[type="number"], input[type="file"] { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .btn { background: #0070f3; color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn:hover { background: #0051b3; }
        .btn-del { background: #ff4d4f; padding: 8px 15px; font-size: 13px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { text-align: left; padding: 15px; border-bottom: 1px solid #eee; }
        .prod-img { width: 50px; height: 50px; border-radius: 5px; object-fit: cover; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Shakil's Hub <small style="font-size: 14px; color: #888;">Control Everything</small></h1>

        <div class="card">
            <h2>üõí ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
            <input type="text" id="pName" placeholder="‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ">
            <input type="number" id="pPrice" placeholder="‡¶¶‡¶æ‡¶Æ (‡¶ü‡¶æ‡¶ï‡¶æ)">
            <p>‡¶õ‡¶¨‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®:</p>
            <input type="file" id="pImage" accept="image/*">
            <button class="btn" onclick="uploadProduct()">‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>

        <div class="card">
            <h2>üì¶ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡ßç‡¶ü‡¶ï</h2>
            <table>
                <thead>
                    <tr><th>‡¶õ‡¶¨‡¶ø</th><th>‡¶®‡¶æ‡¶Æ</th><th>‡¶¶‡¶æ‡¶Æ</th><th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr>
                </thead>
                <tbody id="pBody"></tbody>
            </table>
        </div>

        <div class="card" style="border-left: 5px solid #ffc107;">
            <h2>üîî ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡¶∏‡¶Æ‡ßÇ‡¶π</h2>
            <table>
                <thead>
                    <tr><th>‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th><th>‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶´‡ßã‡¶®</th></tr>
                </thead>
                <tbody id="oBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        async function loadData() {
            const res = await fetch('/api/data');
            const data = await res.json();
            
            // ‡¶™‡¶£‡ßç‡¶Ø ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            const pBody = document.getElementById('pBody');
            pBody.innerHTML = data.products.map(p => `
                <tr>
                    <td><img src="${p.img}" class="prod-img"></td>
                    <td>${p.name}</td>
                    <td>${p.price} BDT</td>
                    <td><button class="btn btn-del" onclick="deleteProduct(${p.id})">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button></td>
                </tr>
            `).join('');

            // ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            const oBody = document.getElementById('oBody');
            oBody.innerHTML = data.orders.map(o => `
                <tr>
                    <td><b>${o.item}</b></td>
                    <td><a href="tel:${o.phone}">${o.phone}</a></td>
                </tr>
            `).join('');
        }

        async function uploadProduct() {
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            const imageFile = document.getElementById('pImage').files[0];

            if(!name || !price || !imageFile) {
                alert("‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!");
                return;
            }

            const formData = new FormData();
            formData.append('name', name);
            formData.append('price', price);
            formData.append('image', imageFile);

            const res = await fetch('/api/add-product', { method: 'POST', body: formData });
            const result = await res.json();
            if(result.success) {
                alert("‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                location.reload();
            }
        }

        async function deleteProduct(id) {
            if(confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§?")) {
                await fetch(`/api/delete-product/${id}`, { method: 'DELETE' });
                loadData();
            }
        }

        loadData();
        setInterval(loadData, 10000); // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶™‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá
    </script>
</body>
</html>
