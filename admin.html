<!DOCTYPE html>
<html>
<head>
    <title>Shakil's Private Admin</title>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; padding: 40px; }
        .box { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; }
        .del-btn { background: #ff4d4d; color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; }
        .add-form { margin-top: 30px; padding: 20px; background: #e3f2fd; border-radius: 15px; }
        input { padding: 10px; margin: 5px; border-radius: 8px; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <div class="box">
        <h1>Marketplace Management</h1>
        <table>
            <thead><tr><th>Product</th><th>Price</th><th>Action</th></tr></thead>
            <tbody id="pList"></tbody>
        </table>

        <div class="add-form">
            <h3>Add New Marketing Product</h3>
            <input type="text" id="pName" placeholder="Product Name">
            <input type="text" id="pPrice" placeholder="Price (BDT)">
            <input type="text" id="pImg" placeholder="Image URL">
            <button onclick="addProduct()" style="background:#0070f3; color:white; border:none; padding:10px 20px; border-radius:8px;">Add Product</button>
        </div>
    </div>

    <script>
        async function loadData() {
            const res = await fetch('/api/data');
            const data = await res.json();
            const list = document.getElementById('pList');
            list.innerHTML = "";
            data.products.forEach(p => {
                list.innerHTML += `<tr>
                    <td>${p.name}</td>
                    <td>${p.price} BDT</td>
                    <td><button class="del-btn" onclick="deleteProduct(${p.id})">Delete</button></td>
                </tr>`;
            });
        }

        async function deleteProduct(id) {
            if(confirm("Are you sure?")) {
                await fetch(`/api/delete-product/${id}`, { method: 'DELETE' });
                loadData();
            }
        }

        async function addProduct() {
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            const img = document.getElementById('pImg').value;
            await fetch('/api/add-product', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({name, price, img})
            });
            loadData();
        }
        loadData();
    </script>
</body>
</html>
